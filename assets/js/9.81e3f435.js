(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{179:function(s,t,a){"use strict";a.r(t);var n=a(0),e=Object(n.a)({},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("div",{staticClass:"content"},[s._m(0),s._v(" "),a("p",[s._v("Cette page comporte des rappels sur le langage SQL. Le diaporama complet est "),a("a",{attrs:{href:"https://docs.google.com/presentation/d/1hn6SA78FhIaXljEb7Pof9WVl0woEjurLm4VCAlHT1mM/",target:"_blank",rel:"noopener noreferrer"}},[s._v("disponible en ligne"),a("OutboundLink")],1),s._v(". Il est possible que certaines notions n'aient pas été abordées lors de la formation.")]),s._v(" "),s._m(1),s._v(" "),a("p",[s._v("Une requête de sélection peut faire apparaitre les éléments suivants :")]),s._v(" "),s._m(2),s._v(" "),a("p",[s._v("Un exemple complet d'une requête (sans intérêt métier) faisant apparaitre les différentes syntaxes possibles est présenté ci-dessous.")]),s._v(" "),s._m(3),a("p",[s._v("Il est recommandé de suivre la présentation ci-dessus en terme de respect de la casse, espacements et retours à la ligne pour faciliter la lisibilité des requêtes et conserver une cohérence.")]),s._v(" "),s._m(4),s._v(" "),a("p",[s._v("Ici sont présentées quelques fonctionnalités supplémentaires du langage SQL qui peuvent être utiles lors de requêtes spécifiques. La liste complète des fonctionnalités peut être trouvée sur un moteur de recherche, pour une base de données PostgreSQL.")]),s._v(" "),s._m(5),s._v(" "),s._m(6),s._v(" "),a("p",[s._v("Ainsi, une requête pour calculer l'année d'il y a 10 ans peut s'exprimer de la façon suivante :")]),s._v(" "),s._m(7),a("p",[s._v("Cette fonctionnalité permet de calculer des choses sur des années glissantes. Par exemple, le nombre d'opérations SAR/MAS/DIV/SUR pour tous les CROSS par année sur les 10 dernières années :")]),s._v(" "),s._m(8),s._m(9),s._v(" "),s._m(10),s._v(" "),s._m(11)])},[function(){var s=this.$createElement,t=this._self._c||s;return t("h1",{attrs:{id:"langage-sql"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#langage-sql","aria-hidden":"true"}},[this._v("#")]),this._v(" Langage SQL")])},function(){var s=this.$createElement,t=this._self._c||s;return t("h2",{attrs:{id:"requete-de-selection"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#requete-de-selection","aria-hidden":"true"}},[this._v("#")]),this._v(" Requête de sélection")])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ul",[a("li",[a("code",[s._v("SELECT")]),s._v(" : les colonnes que l'on veut faire apparaitre dans le résultat ;")]),s._v(" "),a("li",[a("code",[s._v("FROM")]),s._v(" : la table source des données ;")]),s._v(" "),a("li",[a("code",[s._v("JOIN")]),s._v(" : si l'on souhaite travailler avec plusieurs tables, il faut effectuer des jointures et spécifier les colonnes qui doivent correspondre ("),a("code",[s._v("operation_id")]),s._v(" pour SECMAR) ;")]),s._v(" "),a("li",[a("code",[s._v("WHERE")]),s._v(" : les contraintes / filtres à appliquer à nos données (spécifier une année, une situation météo etc.) ;")]),s._v(" "),a("li",[a("code",[s._v("GROUP BY")]),s._v(" : lorsque l'on veut résumer l'information, il faut procéder à un aggrégat pour ne pas avoir autant de lignes que le nombre d'opérations qu'il y a. Cette clause permet d'avoir des résultats par année et par CROSS par exemple ;")]),s._v(" "),a("li",[a("code",[s._v("ORDER BY")]),s._v(" : permet de trier le résultat obtenu selon l'ordre ascendant, descendant des colonnes. On utilise la position d'une colonne et les mots clés "),a("code",[s._v("ASC")]),s._v(" ou "),a("code",[s._v("DESC")]),s._v(".")])])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v("\n  "),a("span",{attrs:{class:"token string"}},[s._v('"stats"')]),a("span",{attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{attrs:{class:"token string"}},[s._v('"annee"')]),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{attrs:{class:"token string"}},[s._v('"op"')]),a("span",{attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{attrs:{class:"token string"}},[s._v('"cross"')]),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{attrs:{class:"token string"}},[s._v('"op"')]),a("span",{attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{attrs:{class:"token string"}},[s._v('"type_operation"')]),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{attrs:{class:"token function"}},[s._v("COUNT")]),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{attrs:{class:"token string"}},[s._v('"op"')]),a("span",{attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{attrs:{class:"token string"}},[s._v('"operation_id"')]),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"nb_operations"')]),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{attrs:{class:"token function"}},[s._v("SUM")]),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{attrs:{class:"token string"}},[s._v('"stats"')]),a("span",{attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{attrs:{class:"token string"}},[s._v('"nombre_personnes_impliquees"')]),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"total_impliques"')]),s._v("\n"),a("span",{attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"operations"')]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"op"')]),s._v("\n"),a("span",{attrs:{class:"token keyword"}},[s._v("JOIN")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"operations_stats"')]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"stats"')]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"stats"')]),a("span",{attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{attrs:{class:"token string"}},[s._v('"operation_id"')]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"op"')]),a("span",{attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{attrs:{class:"token string"}},[s._v('"operation_id"')]),s._v("\n"),a("span",{attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"op"')]),a("span",{attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{attrs:{class:"token string"}},[s._v('"cross"')]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v("'Jobourg'")]),s._v("\n  "),a("span",{attrs:{class:"token operator"}},[s._v("AND")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"op"')]),a("span",{attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{attrs:{class:"token string"}},[s._v('"evenement"')]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("IN")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{attrs:{class:"token string"}},[s._v("'Isolement par la marée / Envasé'")]),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v("'Suicide'")]),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{attrs:{class:"token operator"}},[s._v("AND")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"stats"')]),a("span",{attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{attrs:{class:"token string"}},[s._v('"annee"')]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("BETWEEN")]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("2010")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("AND")]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("2013")]),s._v("\n  "),a("span",{attrs:{class:"token operator"}},[s._v("AND")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{attrs:{class:"token string"}},[s._v('"op"')]),a("span",{attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{attrs:{class:"token string"}},[s._v('"vent_force"')]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("<=")]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("4")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("OR")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"op"')]),a("span",{attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{attrs:{class:"token string"}},[s._v('"vent_force"')]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("7")]),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{attrs:{class:"token comment"}},[s._v("-- Vent jusqu'à 4 ou strictement supérieur à 7")]),s._v("\n  "),a("span",{attrs:{class:"token operator"}},[s._v("AND")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"stats"')]),a("span",{attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{attrs:{class:"token string"}},[s._v('"mois_texte"')]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("<>")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v("'Juin'")]),s._v(" "),a("span",{attrs:{class:"token comment"}},[s._v("-- Tous les mois sauf Juin")]),s._v("\n"),a("span",{attrs:{class:"token keyword"}},[s._v("GROUP")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("1")]),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("2")]),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("3")]),s._v(" "),a("span",{attrs:{class:"token comment"}},[s._v("-- Aggrège par les colonnes 1, 2 et 3 (année, CROSS et type d'opération)")]),s._v("\n"),a("span",{attrs:{class:"token keyword"}},[s._v("ORDER")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("ASC")]),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("DESC")]),s._v(" "),a("span",{attrs:{class:"token comment"}},[s._v("-- Tri par l'ordre ascendant la colonne 1 (année) puis descendant par la colonne 2 (CROSS)")]),s._v("\n")])])])},function(){var s=this.$createElement,t=this._self._c||s;return t("h2",{attrs:{id:"fonctions-supplementaires-en-sql"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#fonctions-supplementaires-en-sql","aria-hidden":"true"}},[this._v("#")]),this._v(" Fonctions supplémentaires en SQL")])},function(){var s=this.$createElement,t=this._self._c||s;return t("h3",{attrs:{id:"annees-glissantes"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#annees-glissantes","aria-hidden":"true"}},[this._v("#")]),this._v(" Années glissantes")])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[this._v("Il est possible dans une requête de récupérer la date courante lors de l'exécution de la requête à l'aide de "),t("code",[this._v("current_date")]),this._v(".")])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{attrs:{class:"token comment"}},[s._v("-- `current_date` donne la date courante")]),s._v("\n"),a("span",{attrs:{class:"token comment"}},[s._v("-- `date_part('year', current_date)` donne seulement l'année de la date courante")]),s._v("\n"),a("span",{attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("date_part"),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{attrs:{class:"token string"}},[s._v("'year'")]),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("current_date")]),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("10")]),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v("\n  "),a("span",{attrs:{class:"token string"}},[s._v('"stats"')]),a("span",{attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{attrs:{class:"token string"}},[s._v('"annee"')]),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{attrs:{class:"token string"}},[s._v('"op"')]),a("span",{attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{attrs:{class:"token string"}},[s._v('"cross"')]),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{attrs:{class:"token string"}},[s._v('"op"')]),a("span",{attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{attrs:{class:"token string"}},[s._v('"type_operation"')]),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{attrs:{class:"token function"}},[s._v("count")]),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{attrs:{class:"token string"}},[s._v('"op"')]),a("span",{attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{attrs:{class:"token string"}},[s._v('"operation_id"')]),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"nb_operations"')]),s._v("\n"),a("span",{attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"operations"')]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"op"')]),s._v("\n"),a("span",{attrs:{class:"token keyword"}},[s._v("JOIN")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"operations_stats"')]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"stats"')]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"stats"')]),a("span",{attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{attrs:{class:"token string"}},[s._v('"operation_id"')]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"op"')]),a("span",{attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{attrs:{class:"token string"}},[s._v('"operation_id"')]),s._v("\n"),a("span",{attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"stats"')]),a("span",{attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{attrs:{class:"token string"}},[s._v('"annee"')]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v(">=")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("date_part"),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{attrs:{class:"token string"}},[s._v("'year'")]),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("current_date")]),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("10")]),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{attrs:{class:"token keyword"}},[s._v("GROUP")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("1")]),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("2")]),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("3")]),s._v("\n")])])])},function(){var s=this.$createElement,t=this._self._c||s;return t("h3",{attrs:{id:"modifications-de-la-casse"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#modifications-de-la-casse","aria-hidden":"true"}},[this._v("#")]),this._v(" Modifications de la casse")])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[this._v("Il est possible de passer du texte tout en majuscules ou tout en minuscules avec les commandes "),t("code",[this._v("UPPER")]),this._v(" et "),t("code",[this._v("LOWER")]),this._v(" respectivement.")])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("DISTINCT")]),s._v("\n    "),a("span",{attrs:{class:"token string"}},[s._v('"cross"')]),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    LOWER"),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{attrs:{class:"token string"}},[s._v('"cross"')]),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"cross_minuscules"')]),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    UPPER"),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{attrs:{class:"token string"}},[s._v('"cross"')]),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"cross_majuscules"')]),s._v("\n"),a("span",{attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"operations"')]),s._v("\n")])])])}],!1,null,null,null);e.options.__file="langage_sql.md";t.default=e.exports}}]);